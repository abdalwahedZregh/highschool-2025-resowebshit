<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة التحليل التعليمي</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background-color: #000000; 
            --container-color: #0a0a0a; 
            --primary-green: #00ff99;
            --primary-red: #ff4d4d;
            --primary-blue: #4d94ff;
            --primary-purple: #a64dff;
            --text-color: #e0e0e0; 
            --border-color: #00ff9930;
            --red-border-color: #ff4d4d30;
            --blue-border-color: #4d94ff30;
            --glow-shadow: 0 0 5px var(--primary-green), 0 0 10px var(--primary-green), 0 0 15px var(--primary-green);
            --red-glow-shadow: 0 0 5px var(--primary-red), 0 0 10px var(--primary-red), 0 0 15px var(--primary-red);
            --blue-glow-shadow: 0 0 5px var(--primary-blue), 0 0 10px var(--primary-blue), 0 0 15px var(--primary-blue);
            --purple-glow-shadow: 0 0 5px var(--primary-purple), 0 0 10px var(--primary-purple), 0 0 15px var(--primary-purple);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body { 
            background-color: var(--background-color); 
            color: var(--text-color); 
            font-family: 'Tajawal', sans-serif; 
            padding: 20px; 
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 255, 153, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(77, 148, 255, 0.05) 0%, transparent 20%);
            min-height: 100vh;
        }
        
        .container { 
            width: 100%; 
            max-width: 1200px; 
            margin: 20px auto; 
            background-color: var(--container-color); 
            border-radius: 15px; 
            padding: 30px; 
            border: 1px solid var(--border-color); 
            box-shadow: 0 0 25px rgba(0, 255, 153, 0.1); 
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-green), var(--primary-blue), var(--primary-purple));
            z-index: 1;
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-green);
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logo:hover {
            text-shadow: var(--glow-shadow);
        }
        
        .logo i {
            color: var(--primary-blue);
        }
        
        .nav-links {
            display: flex;
            gap: 30px;
        }
        
        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 18px;
            padding: 8px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-links a:hover, .nav-links a.active {
            background: rgba(0, 255, 153, 0.1);
            color: var(--primary-green);
        }
        
        .nav-links a i {
            font-size: 20px;
        }
        
        .language-selector {
            position: relative;
            margin-left: 20px;
        }
        
        .language-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        
        .language-toggle:hover {
            color: var(--primary-green);
            background: rgba(0, 255, 153, 0.1);
        }
        
        .language-toggle:hover .language-icon,
        .language-toggle:hover .language-chevron {
            color: var(--primary-green);
        }
        
        .language-icon {
            font-size: 16px;
            transition: color 0.3s ease;
        }
        
        .language-code {
            font-size: 18px;
        }
        
        .language-chevron {
            font-size: 12px;
            transition: color 0.3s ease;
        }
        
        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--container-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 120px;
            z-index: 1001;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .language-dropdown.show {
            display: block;
        }
        
        .language-option {
            padding: 8px 20px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: right;
        }
        
        .language-option:hover {
            color: var(--primary-green);
            background: rgba(0, 255, 153, 0.1);
        }
        
        .page {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .page-header {
            text-align: center;
            margin: 30px 0 50px;
            position: relative;
        }
        
        .page-header h1 {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--primary-green);
            text-shadow: 0 0 10px rgba(0, 255, 153, 0.3);
        }
        
        .page-header p {
            font-size: 18px;
            color: #aaa;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .page-header::after {
            content: "";
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-green), transparent);
            border-radius: 2px;
        }
        
        #home-page .container {
            max-width: 800px;
        }
        
        #search-section { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 30px; 
            position: relative;
        }
        
        #studentNumberInput { 
            flex-grow: 1; 
            padding: 15px 20px; 
            border-radius: 8px; 
            border: 1px solid var(--border-color); 
            background-color: #1a1a1a; 
            color: #fff; 
            font-size: 16px; 
            transition: all 0.3s ease;
        }
        
        #studentNumberInput:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 10px rgba(0, 255, 153, 0.3);
        }
        
        #searchButton { 
            padding: 15px 30px; 
            border-radius: 8px; 
            border: 1px solid var(--primary-green); 
            background-color: transparent; 
            color: var(--primary-green); 
            font-size: 16px; 
            cursor: pointer; 
            transition: 0.3s; 
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        #searchButton:hover { 
            background-color: var(--primary-green); 
            color: var(--background-color); 
            box-shadow: var(--glow-shadow);
            transform: translateY(-2px);
        }
        
        #error-message { 
            color: #ff4d4d; 
            text-align: center; 
            display: none; 
            padding: 10px; 
            background: rgba(255,77,77,0.1);
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,77,77,0.3);
        }
        
        #results-container { 
            opacity: 0; 
            transform: translateY(20px); 
            transition: opacity 0.5s ease, transform 0.5s ease; 
            display: none;
        }
        
        #results-container.visible { 
            opacity: 1; 
            transform: translateY(0); 
        }
        
        .student-header { 
            text-align: center; 
            margin-bottom: 30px; 
            position: relative;
        }
        
        .student-header h2 { 
            font-size: 32px; 
            margin: 10px 0; 
            color: var(--primary-green);
            text-shadow: 0 0 10px rgba(0, 255, 153, 0.3);
        }
        
        .student-info { 
            display: flex; 
            justify-content: center; 
            gap: 30px; 
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .student-info-item { 
            background: rgba(255,255,255,0.05); 
            padding: 10px 20px; 
            border-radius: 8px; 
            border: 1px solid var(--border-color);
            min-width: 150px;
            text-align: center;
        }
        
        .student-info-item p { 
            margin: 5px 0; 
            color: #aaa; 
            font-size: 14px;
        }
        
        .student-info-item span { 
            font-weight: bold; 
            font-size: 18px; 
            color: var(--text-color);
        }
        
        .stats-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
            align-items: center; 
            margin-bottom: 40px; 
        }
        
        .percentage-circle-container { 
            position: relative; 
            width: 150px; 
            height: 150px; 
            margin: auto; 
        }
        
        .percentage-circle-container.has-failure .circle-progress {
            stroke: var(--primary-red);
        }
        
        .percentage-circle-container.has-failure .percentage-text {
            color: var(--primary-red);
        }
        
        .percentage-circle-container svg { 
            width: 100%; 
            height: 100%; 
            transform: rotate(-90deg); 
        }
        
        .circle-bg { 
            fill: none; 
            stroke: #ffffff1a; 
            stroke-width: 10; 
        }
        
        .circle-progress { 
            fill: none; 
            stroke: var(--primary-green); 
            stroke-width: 10; 
            stroke-linecap: round; 
            transition: stroke-dashoffset 1s ease-out; 
        }
        
        .percentage-text { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            font-size: 28px; 
            font-weight: bold; 
            color: var(--primary-green); 
        }
        
        .rank-item { 
            text-align: center; 
        }
        
        .rank-item p { 
            margin: 0; 
            font-size: 16px; 
            color: #aaa; 
            margin-bottom: 5px; 
        }
        
        .rank-item span { 
            font-size: 2.5em; 
            font-weight: bold; 
        }
        
        .rank-item .rank-normal { 
            color: var(--text-color); 
            display: block;
            font-size: 40px;
            margin: 10px 0;
        }
        
        .rank-item .rank-unique { 
            font-size: 1.2em; 
            color: #aaa; 
            background: rgba(255,255,255,0.05);
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
            margin-top: 10px;
        }
        
        .subject-bars-container h3 { 
            text-align: center; 
            margin-bottom: 20px; 
            color: var(--primary-green); 
            font-size: 22px;
            position: relative;
            padding-bottom: 10px;
        }
        
        .subject-bars-container h3::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary-green), transparent);
        }
        
        .subject-bar { 
            margin-bottom: 20px; 
        }
        
        .subject-bar-info { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 5px; 
            font-size: 16px;
        }
        
        .subject-bar-info .failed-label {
            color: var(--primary-red);
            font-weight: bold;
        }
        
        .progress-bar-bg { 
            width: 100%; 
            height: 12px; 
            background-color: #ffffff1a; 
            border-radius: 6px; 
            overflow: hidden; 
        }
        
        .progress-bar-fill { 
            width: 0; 
            height: 100%; 
            background: linear-gradient(90deg, #00ff99, #00cc77); 
            border-radius: 6px; 
            transition: width 1s ease-out; 
            position: relative;
        }
        
        .progress-bar-fill.failed {
            background: linear-gradient(90deg, #ff4d4d, #cc0000) !important;
        }
        
        .progress-bar-fill::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            background-size: 200% 100%;
            animation: shine 2s infinite;
            border-radius: 6px;
        }
        
        @keyframes shine {
            0% { background-position: -100% 0; }
            100% { background-position: 100% 0; }
        }
        
        #result-feedback-banner { 
            position: fixed; 
            bottom: -100px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: rgba(0, 255, 153, 0.1); 
            backdrop-filter: blur(5px); 
            padding: 15px 30px; 
            border-radius: 30px; 
            border: 1px solid var(--border-color); 
            transition: bottom 0.5s ease-in-out; 
            z-index: 100; 
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        #result-feedback-banner.has-failure {
            background: rgba(255, 77, 77, 0.1);
            border: 1px solid var(--red-border-color);
        }
        
        #result-feedback-banner.visible { 
            bottom: 20px; 
        }
        
        .support-btn {
            background: var(--primary-red);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
        }
        
        .support-btn:hover {
            background: #e60000;
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 77, 77, 0.5);
        }
        
        #chart-container { 
            height: 300px; 
            margin-top: 40px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid var(--border-color);
        }
        
        #performanceChart { 
            width: 100% !important; 
            height: 100% !important; 
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .subject-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
        }
        
        .subject-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--blue-glow-shadow);
            border-color: var(--primary-blue);
        }
        
        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .subject-title {
            font-size: 24px;
            color: var(--primary-blue);
        }
        
        .subject-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--border-color);
        }
        
        .stat-card h4 {
            color: #aaa;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .stat-card .value {
            font-size: 24px;
            font-weight: bold;
        }
        
        /* Dashboard Styles */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-box {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: var(--purple-glow-shadow);
            border-color: var(--primary-purple);
        }
        
        .stat-box i {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--primary-green);
        }
        
        .stat-box h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--primary-blue);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--text-color);
        }
        
        .requests-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            overflow: hidden;
        }
        
        .requests-table th {
            background: rgba(0, 255, 153, 0.1);
            padding: 15px;
            text-align: right;
            color: var(--primary-green);
            border-bottom: 1px solid var(--border-color);
        }
        
        .requests-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
        }
        
        .requests-table tr:last-child td {
            border-bottom: none;
        }
        
        .requests-table tr:hover {
            background: rgba(0, 255, 153, 0.05);
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .status-new {
            background: rgba(0, 255, 153, 0.2);
            color: var(--primary-green);
        }
        
        .status-processed {
            background: rgba(77, 148, 255, 0.2);
            color: var(--primary-blue);
        }
        
        /* Password Form */
        .password-form {
            max-width: 500px;
            margin: 100px auto;
            padding: 40px;
            background: var(--container-color);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            text-align: center;
        }
        
        .password-form h2 {
            color: var(--primary-green);
            margin-bottom: 20px;
        }
        
        .password-form p {
            color: #aaa;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .password-input {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .password-input input {
            flex-grow: 1;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: #1a1a1a;
            color: #fff;
            font-size: 16px;
        }
        
        .password-btn {
            padding: 15px 30px;
            border-radius: 8px;
            background: var(--primary-green);
            color: #000;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .password-btn:hover {
            background: #00cc77;
            box-shadow: var(--glow-shadow);
        }
        
        .error-message {
            color: var(--primary-red);
            margin-top: 10px;
            display: none;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .requests-table {
                display: block;
                overflow-x: auto;
            }
            
            .password-input {
                flex-direction: column;
            }
        }
        
        .fade-out {
            animation: fadeOut 1s forwards;
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; bottom: -100px; }
        }
        
        /* Secret Access Animation */
        @keyframes secretAccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .secret-access {
            animation: secretAccess 0.5s ease;
        }
        
        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            display: none;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--container-color);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid var(--border-color);
            position: relative;
            max-width: 90%;
            width: 500px;
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            left: 15px;
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .modal-close:hover {
            color: var(--primary-red);
        }
        
        /* Shake animation for password error */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }
        
        .shake {
            animation: shake 0.5s ease;
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="logo" id="dashboardSecret">
            <i class="fas fa-graduation-cap"></i>
            <span>منصة التحليل التعليمي</span>
        </div>
        
        <div class="nav-links">
            <a href="#home" class="nav-link active" data-page="home-page">
                <i class="fas fa-home"></i> الرئيسية
            </a>
            <a href="#analytics" class="nav-link" data-page="analytics-page">
                <i class="fas fa-chart-bar"></i> التحليلات
            </a>
            <a href="#about" class="nav-link" data-page="about-page">
                <i class="fas fa-info-circle"></i> من نحن
            </a>
            
            <!-- Language Selector -->
            <div class="language-selector">
                <div class="language-toggle" id="languageToggle">
                    <span class="language-icon">🌐</span>
                    <span class="language-code">AR</span>
                    <span class="language-chevron">▼</span>
                </div>
                <div class="language-dropdown" id="languageDropdown">
                    <div class="language-option" data-lang="en">English</div>
                    <div class="language-option" data-lang="tr">Türkçe</div>
                    <div class="language-option" data-lang="ar">العربية</div>
                </div>
            </div>
        </div>
    </nav>

    <div id="home-page" class="page active">
        <div class="container">
            <div class="page-header">
                <h1>نتائج الشهادة الثانوية - 2025</h1>
                <p>استعرض نتائجك التفصيلية، احصل على تحليل أدائك، وقارن نفسك مع زملائك في جميع المواد الدراسية</p>
            </div>
            
            <main>
                <section id="search-section">
                    <input type="number" id="studentNumberInput" placeholder="أدخل رقم القيد الخاص بك...">
                    <button id="searchButton">
                        <i class="fas fa-search"></i> بحث
                    </button>
                </section>
                <p id="error-message">لا يوجد طالب بهذا الرقم.</p>
                <div id="results-container"></div>
            </main>
        </div>
        
        <div id="result-feedback-banner" class="result-feedback-banner"></div>
    </div>

    <div id="analytics-page" class="page">
        <div class="container">
            <div class="page-header">
                <h1>تحليلات المواد الدراسية</h1>
                <p>استكشف أداء الطلاب في جميع المواد الدراسية، احصل على إحصائيات مفصلة وتوزيع الدرجات لكل مادة</p>
            </div>
            
            <div id="analytics-container">
                <!-- Content will be loaded dynamically -->
            </div>
        </div>
    </div>

    <div id="about-page" class="page">
        <div class="container">
            <div class="page-header">
                <h1>عن المنصة التعليمية</h1>
                <p>تعرف على منصتنا، مصادر بياناتنا، وشروط استخدام الخدمة</p>
            </div>
            
            <div class="about-content">
                <div class="about-section">
                    <h2><i class="fas fa-file-contract"></i> شروط الخدمة</h2>
                    <p>مرحبًا بكم في منصة التحليل التعليمي. يرجى قراءة شروط الخدمة هذه بعناية قبل استخدام موقعنا.</p>
                    
                    <div class="info-box">
                        <p><strong>القبول بالشروط:</strong> باستخدامك لهذه المنصة، فإنك توافق على الالتزام بهذه الشروط والأحكام.</p>
                    </div>
                    
                    <p><strong>1. الاستخدام المسموح به:</strong> يُسمح لك باستخدام هذه المنصة لأغراض شخصية وغير تجارية فقط. لا يجوز لك استخدام محتوى المنصة لأي غرض تجاري دون الحصول على إذن كتابي مسبق منا.</p>
                    
                    <p><strong>2. دقة المعلومات:</strong> نبذل جهودًا معقولة لضمان دقة المعلومات المعروضة على المنصة، ولكننا لا نضمن اكتمالها أو دقتها أو موثوقيتها. أي اعتماد على هذه المعلومات يكون على مسؤوليتك الخاصة.</p>
                    
                    <p><strong>3. الملكية الفكرية:</strong> جميع المحتويات الموجودة على المنصة، بما في ذلك النصوص والرسومات والشعارات والصور والبرمجيات، هي ملك لنا أو لموردينا ومحمية بقوانين الملكية الفكرية.</p>
                    
                    <p><strong>4. التعديلات:</strong> نحتفظ بالحق في تعديل هذه الشروط في أي وقت. سيتم نشر أي تغييرات على هذه الصفحة، وسيكون تاريخ التحديث الأخير في أسفل الصفحة.</p>
                </div>
                
                <div class="about-section">
                    <h2><i class="fas fa-database"></i> مصدر البيانات</h2>
                    <p>تلتزم منصتنا بالشفافية فيما يتعلق بمصادر البيانات التي نعرضها:</p>
                    
                    <div class="info-box">
                        <p>جميع البيانات المعروضة على هذه المنصة تم الحصول عليها من المصادر الرسمية المعلنة من قبل وزارة التعليم.</p>
                    </div>
                    
                    <p><strong>1. المصادر الرسمية:</strong> تستند جميع البيانات المعروضة على هذه المنصة إلى المعلومات المنشورة رسميًا من قبل وزارة التعليم والجهات التابعة لها. نحن نضمن أن البيانات التي نقدمها هي نفسها المتاحة للجمهور عبر القنوات الرسمية.</p>
                    
                    <p><strong>2. تحديث البيانات:</strong> يتم تحديث البيانات بشكل دوري لضمان دقتها وحداثتها. ومع ذلك، قد يكون هناك تأخير بين نشر البيانات رسميًا وعرضها على منصتنا.</p>
                    
                    <p><strong>3. خصوصية البيانات:</strong> نحن نلتزم التزامًا تامًا بقوانين حماية البيانات وخصوصية المعلومات. لا نقوم بجمع أو تخزين أي معلومات شخصية حساسة خارج نطاق البيانات المتاحة للعموم.</p>
                    
                    <p><strong>4. الشفافية:</strong> نؤمن بحق الجمهور في الوصول إلى المعلومات التعليمية بشكل شفاف. تهدف منصتنا إلى تقديم هذه المعلومات بطريقة سهلة الفهم والاستخدام.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="dashboard-page" class="page">
        <div class="container">
            <div class="page-header">
                <h1>لوحة تحكم الطلاب الراسبين</h1>
                <p>عرض إحصائيات الطلاب والطلبات المقدمة لدورات الدعم</p>
            </div>
            
            <div class="dashboard-stats">
                <div class="stat-box">
                    <i class="fas fa-users"></i>
                    <h3>إجمالي الطلاب</h3>
                    <div class="stat-value" id="total-students">1,247</div>
                </div>
                
                <div class="stat-box">
                    <i class="fas fa-user-graduate"></i>
                    <h3>الطلاب الناجحون</h3>
                    <div class="stat-value" id="passing-students">1,035</div>
                </div>
                
                <div class="stat-box">
                    <i class="fas fa-user-times"></i>
                    <h3>الطلاب الراسبون</h3>
                    <div class="stat-value" id="failing-students">212</div>
                </div>
                
                <div class="stat-box">
                    <i class="fas fa-percentage"></i>
                    <h3>نسبة النجاح</h3>
                    <div class="stat-value" id="pass-rate">83.1%</div>
                </div>
            </div>
            
            <div class="subject-card">
                <div class="subject-header">
                    <h3 class="subject-title"><i class="fas fa-chart-pie"></i> توزيع الطلاب حسب المسار</h3>
                </div>
                
                <div class="histogram-container">
                    <canvas id="streamChart"></canvas>
                </div>
            </div>
            
            <div class="subject-card">
                <div class="subject-header">
                    <h3 class="subject-title"><i class="fas fa-life-ring"></i> طلبات دورات الدعم</h3>
                    <div>
                        <button class="modal-btn cancel" id="exportRequestsBtn">
                            <i class="fas fa-file-export"></i> تصدير البيانات
                        </button>
                    </div>
                </div>
                
                <table class="requests-table">
                    <thead>
                        <tr>
                            <th>اسم الطالب</th>
                            <th>رقم القيد</th>
                            <th>المواد الراسبة</th>
                            <th>المدينة</th>
                            <th>رقم الهاتف</th>
                            <th>تاريخ الطلب</th>
                            <th>الحالة</th>
                        </tr>
                    </thead>
                    <tbody id="supportRequestsBody">
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="password-modal">
        <div class="modal-content">
            <div class="password-form">
                <h2><i class="fas fa-lock"></i> لوحة التحكم الآمنة</h2>
                <p>هذه الصفحة مخصصة للمديرين فقط. الرجاء إدخال كلمة المرور للوصول إلى لوحة التحكم.</p>
                
                <div class="password-input">
                    <input type="password" id="password-input" placeholder="أدخل كلمة المرور...">
                    <button class="password-btn" id="password-btn">دخول</button>
                </div>
                
                <div class="error-message" id="password-error">
                    <i class="fas fa-exclamation-circle"></i> كلمة المرور غير صحيحة
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="supportModal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">&times;</button>
            <h2 class="modal-title">طلب دورة الدعم</h2>
            
            <form id="supportForm">
                <div class="form-group">
                    <label for="studentName">اسم الطالب</label>
                    <input type="text" id="studentName" disabled>
                </div>
                
                <div class="form-group">
                    <label for="failingSubjects">المواد الراسبة</label>
                    <textarea id="failingSubjects" rows="2" disabled></textarea>
                </div>
                
                <div class="form-group">
                    <label for="city">المدينة</label>
                    <input type="text" id="city" required>
                </div>
                
                <div class="form-group">
                    <label for="phone">رقم الهاتف</label>
                    <input type="tel" id="phone" required>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="modal-btn cancel" id="cancelSupport">إلغاء</button>
                    <button type="submit" class="modal-btn submit">إرسال الطلب</button>
                </div>
            </form>
        </div>
    </div>

    <script>
    // ==================== GLOBAL DATA ====================
    const studentResultsCache = {};
    const subjectAnalyticsCache = {};
    let performanceChart = null;
    let feedbackTimeout = null;
    let currentPage = 'home-page';
    let studentsData = [];
    let supportRequests = JSON.parse(localStorage.getItem('supportRequests')) || [];
    
    // Correct password for dashboard access
    const DASHBOARD_PASSWORD = "admin123";
    
    // Enhanced translations with dashboard content
    const translations = {
        'ar': {
            'home': 'الرئيسية',
            'analytics': 'التحليلات',
            'about': 'من نحن',
            'searchPlaceholder': 'أدخل رقم القيد الخاص بك...',
            'searchButton': 'بحث',
            'errorMessage': 'لا يوجد طالب بهذا الرقم.',
            'resultsTitle': 'نتائج الشهادة الثانوية - 2025',
            'resultsSubtitle': 'استعرض نتائجك التفصيلية، احصل على تحليل أدائك، وقارن نفسك مع زملائك في جميع المواد الدراسية',
            'analyticsTitle': 'تحليلات المواد الدراسية',
            'analyticsSubtitle': 'استكشف أداء الطلاب في جميع المواد الدراسية، احصل على إحصائيات مفصلة وتوزيع الدرجات لكل مادة',
            'aboutTitle': 'عن المنصة التعليمية',
            'aboutSubtitle': 'تعرف على منصتنا، مصادر بياناتنا، وشروط استخدام الخدمة',
            'termsTitle': 'شروط الخدمة',
            'termsIntro': 'مرحبًا بكم في منصة التحليل التعليمي. يرجى قراءة شروط الخدمة هذه بعناية قبل استخدام موقعنا.',
            'termsAcceptance': '<strong>القبول بالشروط:</strong> باستخدامك لهذه المنصة، فإنك توافق على الالتزام بهذه الشروط والأحكام.',
            'termsUsage': '<strong>1. الاستخدام المسموح به:</strong> يُسمح لك باستخدام هذه المنصة لأغراض شخصية وغير تجارية فقط. لا يجوز لك استخدام محتوى المنصة لأي غرض تجاري دون الحصول على إذن كتابي مسبق منا.',
            'termsAccuracy': '<strong>2. دقة المعلومات:</strong> نبذل جهودًا معقولة لضمان دقة المعلومات المعروضة على المنصة، ولكننا لا نضمن اكتمالها أو دقتها أو موثوقيتها. أي اعتماد على هذه المعلومات يكون على مسؤوليتك الخاصة.',
            'termsIntellectual': '<strong>3. الملكية الفكرية:</strong> جميع المحتويات الموجودة على المنصة، بما في ذلك النصوص والرسومات والشعارات والصور والبرمجيات، هي ملك لنا أو لموردينا ومحمية بقوانين الملكية الفكرية.',
            'termsModifications': '<strong>4. التعديلات:</strong> نحتفظ بالحق في تعديل هذه الشروط في أي وقت. سيتم نشر أي تغييرات على هذه الصفحة، وسيكون تاريخ التحديث الأخير في أسفل الصفحة.',
            'dataTitle': 'مصدر البيانات',
            'dataIntro': 'تلتزم منصتنا بالشفافية فيما يتعلق بمصادر البيانات التي نعرضها:',
            'dataSource': 'جميع البيانات المعروضة على هذه المنصة تم الحصول عليها من المصادر الرسمية المعلنة من قبل وزارة التعليم.',
            'dataOfficial': '<strong>1. المصادر الرسمية:</strong> تستند جميع البيانات المعروضة على هذه المنصة إلى المعلومات المنشورة رسميًا من قبل وزارة التعليم والجهات التابعة لها. نحن نضمن أن البيانات التي نقدمها هي نفسها المتاحة للجمهور عبر القنوات الرسمية.',
            'dataUpdates': '<strong>2. تحديث البيانات:</strong> يتم تحديث البيانات بشكل دوري لضمان دقتها وحداثتها. ومع ذلك، قد يكون هناك تأخير بين نشر البيانات رسميًا وعرضها على منصتنا.',
            'dataPrivacy': '<strong>3. خصوصية البيانات:</strong> نحن نلتزم التزامًا تامًا بقوانين حماية البيانات وخصوصية المعلومات. لا نقوم بجمع أو تخزين أي معلومات شخصية حساسة خارج نطاق البيانات المتاحة للعموم.',
            'dataTransparency': '<strong>4. الشفافية:</strong> نؤمن بحق الجمهور في الوصول إلى المعلومات التعليمية بشكل شفاف. تهدف منصتنا إلى تقديم هذه المعلومات بطريقة سهلة الفهم والاستخدام.',
            'dashboardTitle': 'لوحة تحكم الطلاب الراسبين',
            'dashboardSubtitle': 'عرض إحصائيات الطلاب والطلبات المقدمة لدورات الدعم',
            'totalStudents': 'إجمالي الطلاب',
            'passingStudents': 'الطلاب الناجحون',
            'failingStudents': 'الطلاب الراسبون',
            'passRate': 'نسبة النجاح',
            'streamDistribution': 'توزيع الطلاب حسب المسار',
            'supportRequests': 'طلبات دورات الدعم',
            'studentName': 'اسم الطالب',
            'studentNumber': 'رقم القيد',
            'failingSubjects': 'المواد الراسبة',
            'city': 'المدينة',
            'phone': 'رقم الهاتف',
            'requestDate': 'تاريخ الطلب',
            'status': 'الحالة',
            'exportData': 'تصدير البيانات',
            'passwordTitle': 'لوحة التحكم الآمنة',
            'passwordDesc': 'هذه الصفحة مخصصة للمديرين فقط. الرجاء إدخال كلمة المرور للوصول إلى لوحة التحكم.',
            'passwordPlaceholder': 'أدخل كلمة المرور...',
            'passwordButton': 'دخول',
            'passwordError': 'كلمة المرور غير صحيحة',
            'supportTitle': 'طلب دورة الدعم',
            'supportName': 'اسم الطالب',
            'supportSubjects': 'المواد الراسبة',
            'supportCity': 'المدينة',
            'supportPhone': 'رقم الهاتف',
            'supportCancel': 'إلغاء',
            'supportSubmit': 'إرسال الطلب'
        },
        'en': {
            'home': 'Home',
            'analytics': 'Analytics',
            'about': 'About',
            'searchPlaceholder': 'Enter your student number...',
            'searchButton': 'Search',
            'errorMessage': 'No student found with this number.',
            'resultsTitle': 'Secondary Certificate Results - 2025',
            'resultsSubtitle': 'View your detailed results, get performance analysis, and compare yourself with peers in all subjects',
            'analyticsTitle': 'Subject Analytics',
            'analyticsSubtitle': 'Explore student performance in all subjects, get detailed statistics and grade distributions',
            'aboutTitle': 'About the Platform',
            'aboutSubtitle': 'Learn about our platform, data sources, and terms of service',
            'termsTitle': 'Terms of Service',
            'termsIntro': 'Welcome to the Educational Analysis Platform. Please read these Terms of Service carefully before using our site.',
            'termsAcceptance': '<strong>Acceptance of Terms:</strong> By using this platform, you agree to comply with these terms and conditions.',
            'termsUsage': '<strong>1. Permitted Use:</strong> You are allowed to use this platform for personal and non-commercial purposes only. You may not use the content of the platform for any commercial purpose without obtaining prior written permission from us.',
            'termsAccuracy': '<strong>2. Accuracy of Information:</strong> We make reasonable efforts to ensure the accuracy of the information displayed on the platform, but we do not guarantee its completeness, accuracy, or reliability. Any reliance on this information is at your own risk.',
            'termsIntellectual': '<strong>3. Intellectual Property:</strong> All content on the platform, including texts, graphics, logos, images, and software, is owned by us or our suppliers and is protected by intellectual property laws.',
            'termsModifications': '<strong>4. Modifications:</strong> We reserve the right to modify these terms at any time. Any changes will be published on this page, and the last update date will be at the bottom of the page.',
            'dataTitle': 'Data Source',
            'dataIntro': 'Our platform is committed to transparency regarding the sources of the data we display:',
            'dataSource': 'All data displayed on this platform has been obtained from official sources announced by the Ministry of Education.',
            'dataOfficial': '<strong>1. Official Sources:</strong> All data displayed on this platform is based on information officially published by the Ministry of Education and its affiliated entities. We guarantee that the data we provide is the same as that available to the public through official channels.',
            'dataUpdates': '<strong>2. Data Updates:</strong> Data is updated periodically to ensure its accuracy and timeliness. However, there may be a delay between the official publication of data and its display on our platform.',
            'dataPrivacy': '<strong>3. Data Privacy:</strong> We are fully committed to data protection laws and privacy of information. We do not collect or store any sensitive personal information beyond the scope of publicly available data.',
            'dataTransparency': '<strong>4. Transparency:</strong> We believe in the public\'s right to access educational information transparently. Our platform aims to present this information in an easy-to-understand and usable manner.',
            'dashboardTitle': 'Failing Students Dashboard',
            'dashboardSubtitle': 'View student statistics and support course requests',
            'totalStudents': 'Total Students',
            'passingStudents': 'Passing Students',
            'failingStudents': 'Failing Students',
            'passRate': 'Pass Rate',
            'streamDistribution': 'Student Distribution by Stream',
            'supportRequests': 'Support Course Requests',
            'studentName': 'Student Name',
            'studentNumber': 'Student Number',
            'failingSubjects': 'Failing Subjects',
            'city': 'City',
            'phone': 'Phone',
            'requestDate': 'Request Date',
            'status': 'Status',
            'exportData': 'Export Data',
            'passwordTitle': 'Secure Dashboard',
            'passwordDesc': 'This page is for administrators only. Please enter the password to access the dashboard.',
            'passwordPlaceholder': 'Enter password...',
            'passwordButton': 'Login',
            'passwordError': 'Incorrect password',
            'supportTitle': 'Support Course Request',
            'supportName': 'Student Name',
            'supportSubjects': 'Failing Subjects',
            'supportCity': 'City',
            'supportPhone': 'Phone',
            'supportCancel': 'Cancel',
            'supportSubmit': 'Submit Request'
        },
        'tr': {
            'home': 'Ana Sayfa',
            'analytics': 'Analizler',
            'about': 'Hakkımızda',
            'searchPlaceholder': 'Öğrenci numaranızı girin...',
            'searchButton': 'Ara',
            'errorMessage': 'Bu numaraya sahip öğrenci bulunamadı.',
            'resultsTitle': 'Lise Sertifika Sonuçları - 2025',
            'resultsSubtitle': 'Detaylı sonuçlarınızı görüntüleyin, performans analizi alın ve tüm derslerde kendinizi akranlarınızla karşılaştırın',
            'analyticsTitle': 'Ders Analizleri',
            'analyticsSubtitle': 'Tüm derslerde öğrenci performansını keşfedin, detaylı istatistikler ve not dağılımları alın',
            'aboutTitle': 'Platform Hakkında',
            'aboutSubtitle': 'Platformumuz, veri kaynaklarımız ve hizmet şartları hakkında bilgi edinin',
            'termsTitle': 'Hizmet Şartları',
            'termsIntro': 'Eğitim Analiz Platformuna hoş geldiniz. Sitemizi kullanmadan önce lütfen bu Hizmet Şartlarını dikkatlice okuyun.',
            'termsAcceptance': '<strong>Şartları Kabul:</strong> Bu platformu kullanarak, bu şart ve koşullara uymayı kabul etmiş olursunuz.',
            'termsUsage': '<strong>1. İzin Verilen Kullanım:</strong> Bu platformu yalnızca kişisel ve ticari olmayan amaçlar için kullanabilirsiniz. Platformun içeriğini bizden önceden yazılı izin almadan herhangi bir ticari amaç için kullanamazsınız.',
            'termsAccuracy': '<strong>2. Bilgilerin Doğruluğu:</strong> Platformda görüntülenen bilgilerin doğruluğunu sağlamak için makul çabalar sarf ediyoruz, ancak bunların tamlığını, doğruluğunu veya güvenilirliğini garanti etmiyoruz. Bu bilgilere güvenmek kendi sorumluluğunuzdadır.',
            'termsIntellectual': '<strong>3. Fikri Mülkiyet:</strong> Platformdaki tüm içerikler (metinler, grafikler, logolar, resimler ve yazılımlar dahil) bizim veya tedarikçilerimiz tarafından sahiplenilir ve fikri mülkiyet yasalarıyla korunur.',
            'termsModifications': '<strong>4. Değişiklikler:</strong> Bu şartları istediğimiz zaman değiştirme hakkını saklı tutarız. Herhangi bir değişiklik bu sayfada yayınlanacak ve son güncelleme tarihi sayfanın altında yer alacaktır.',
            'dataTitle': 'Veri Kaynağı',
            'dataIntro': 'Platformumuz, görüntülediğimiz verilerin kaynakları konusunda şeffaflığa bağlıdır:',
            'dataSource': 'Bu platformda görüntülenen tüm veriler Eğitim Bakanlığı tarafından açıklanan resmi kaynaklardan elde edilmiştir.',
            'dataOfficial': '<strong>1. Resmi Kaynaklar:</strong> Bu platformda görüntülenen tüm veriler, Eğitim Bakanlığı ve bağlı kuruluşları tarafından resmi olarak yayınlanan bilgilere dayanmaktadır. Sağladığımız verilerin resmi kanallar aracılığıyla kamuya açık olanlarla aynı olduğunu garanti ediyoruz.',
            'dataUpdates': '<strong>2. Veri Güncellemeleri:</strong> Verilerin doğruluğunu ve güncelliğini sağlamak için periyodik olarak güncellenir. Ancak, verilerin resmi olarak yayınlanması ile platformumuzda görüntülenmesi arasında bir gecikme olabilir.',
            'dataPrivacy': '<strong>3. Veri Gizliliği:</strong> Veri koruma yasalarına ve bilgi gizliliğine tam olarak bağlıyız. Kamuya açık verilerin kapsamı dışında herhangi bir hassas kişisel bilgiyi toplamıyoruz veya depolamıyoruz.',
            'dataTransparency': '<strong>4. Şeffaflık:</strong> Kamunun eğitim bilgilerine şeffaf bir şekilde erişme hakkına inanıyoruz. Platformumuz, bu bilgileri kolay anlaşılır ve kullanılabilir bir şekilde sunmayı amaçlamaktadır.',
            'dashboardTitle': 'Başarısız Öğrenci Panosu',
            'dashboardSubtitle': 'Öğrenci istatistiklerini ve destek kursu taleplerini görüntüleyin',
            'totalStudents': 'Toplam Öğrenci',
            'passingStudents': 'Başarılı Öğrenciler',
            'failingStudents': 'Başarısız Öğrenciler',
            'passRate': 'Başarı Oranı',
            'streamDistribution': 'Öğrenci Dağılımı (Dal)',
            'supportRequests': 'Destek Kursu Talepleri',
            'studentName': 'Öğrenci Adı',
            'studentNumber': 'Öğrenci Numarası',
            'failingSubjects': 'Başarısız Dersler',
            'city': 'Şehir',
            'phone': 'Telefon',
            'requestDate': 'Talep Tarihi',
            'status': 'Durum',
            'exportData': 'Veriyi Dışa Aktar',
            'passwordTitle': 'Güvenli Kontrol Paneli',
            'passwordDesc': 'Bu sayfa yalnızca yöneticiler içindir. Kontrol paneline erişmek için lütfen şifreyi girin.',
            'passwordPlaceholder': 'Şifrenizi girin...',
            'passwordButton': 'Giriş',
            'passwordError': 'Yanlış şifre',
            'supportTitle': 'Destek Kursu Talebi',
            'supportName': 'Öğrenci Adı',
            'supportSubjects': 'Başarısız Dersler',
            'supportCity': 'Şehir',
            'supportPhone': 'Telefon',
            'supportCancel': 'İptal',
            'supportSubmit': 'Talebi Gönder'
        }
    };

    let currentLanguage = 'ar';

    function updateLanguage(lang) {
        currentLanguage = lang;
        document.querySelector('.language-code').textContent = lang.toUpperCase();
        
        // Update navigation links
        document.querySelector('[data-page="home-page"]').innerHTML = `<i class="fas fa-home"></i> ${translations[lang]['home']}`;
        document.querySelector('[data-page="analytics-page"]').innerHTML = `<i class="fas fa-chart-bar"></i> ${translations[lang]['analytics']}`;
        document.querySelector('[data-page="about-page"]').innerHTML = `<i class="fas fa-info-circle"></i> ${translations[lang]['about']}`;
        
        // Update home page
        document.querySelector('#home-page .page-header h1').textContent = translations[lang]['resultsTitle'];
        document.querySelector('#home-page .page-header p').textContent = translations[lang]['resultsSubtitle'];
        document.querySelector('#studentNumberInput').placeholder = translations[lang]['searchPlaceholder'];
        document.querySelector('#searchButton').innerHTML = `<i class="fas fa-search"></i> ${translations[lang]['searchButton']}`;
        document.querySelector('#error-message').textContent = translations[lang]['errorMessage'];
        
        // Update analytics page
        document.querySelector('#analytics-page .page-header h1').textContent = translations[lang]['analyticsTitle'];
        document.querySelector('#analytics-page .page-header p').textContent = translations[lang]['analyticsSubtitle'];
        
        // Update about page
        document.querySelector('#about-page .page-header h1').textContent = translations[lang]['aboutTitle'];
        document.querySelector('#about-page .page-header p').textContent = translations[lang]['aboutSubtitle'];
        
        // Update dashboard page
        if (document.getElementById('dashboard-page')) {
            document.querySelector('#dashboard-page .page-header h1').textContent = translations[lang]['dashboardTitle'];
            document.querySelector('#dashboard-page .page-header p').textContent = translations[lang]['dashboardSubtitle'];
            
            // Update dashboard content
            document.querySelectorAll('.stat-box h3').forEach((el, index) => {
                const labels = [
                    translations[lang]['totalStudents'],
                    translations[lang]['passingStudents'],
                    translations[lang]['failingStudents'],
                    translations[lang]['passRate']
                ];
                if (labels[index]) el.textContent = labels[index];
            });
            
            document.querySelector('#streamChart').previousElementSibling.textContent = translations[lang]['streamDistribution'];
            document.querySelector('#supportRequestsTitle').textContent = translations[lang]['supportRequests'];
            document.querySelector('#exportRequestsBtn').innerHTML = `<i class="fas fa-file-export"></i> ${translations[lang]['exportData']}`;
            
            // Update table headers
            const headers = document.querySelectorAll('.requests-table th');
            if (headers.length >= 7) {
                headers[0].textContent = translations[lang]['studentName'];
                headers[1].textContent = translations[lang]['studentNumber'];
                headers[2].textContent = translations[lang]['failingSubjects'];
                headers[3].textContent = translations[lang]['city'];
                headers[4].textContent = translations[lang]['phone'];
                headers[5].textContent = translations[lang]['requestDate'];
                headers[6].textContent = translations[lang]['status'];
            }
        }
        
        // Update password modal
        document.querySelector('#password-modal .password-form h2').textContent = translations[lang]['passwordTitle'];
        document.querySelector('#password-modal .password-form p').textContent = translations[lang]['passwordDesc'];
        document.querySelector('#password-input').placeholder = translations[lang]['passwordPlaceholder'];
        document.querySelector('#password-btn').textContent = translations[lang]['passwordButton'];
        document.querySelector('#password-error').innerHTML = `<i class="fas fa-exclamation-circle"></i> ${translations[lang]['passwordError']}`;
        
        // Update support modal
        document.querySelector('#supportModal .modal-title').textContent = translations[lang]['supportTitle'];
        document.querySelector('#supportModal label[for="studentName"]').textContent = translations[lang]['supportName'];
        document.querySelector('#supportModal label[for="failingSubjects"]').textContent = translations[lang]['supportSubjects'];
        document.querySelector('#supportModal label[for="city"]').textContent = translations[lang]['supportCity'];
        document.querySelector('#supportModal label[for="phone"]').textContent = translations[lang]['supportPhone'];
        document.querySelector('#cancelSupport').textContent = translations[lang]['supportCancel'];
        document.querySelector('#supportForm .modal-btn.submit').textContent = translations[lang]['supportSubmit'];
        
        // Close dropdown
        document.getElementById('languageDropdown').classList.remove('show');
    }

    // ==================== STUDENT DATA FUNCTIONS ====================
    async function fetchStudentData() {
        try {
            // Simulate API call
            await new Promise(resolve => setTimeout(resolve, 800));
            
            // Sample data for demonstration
            studentsData = [
                {
                    "number": 3390599,
                    "name": "دعاء سالم الهادى التميمى",
                    "stream": "علمي",
                    "overallPercentage": 86.8,
                    "result": "ممتاز",
                    "subjectsPassed": 9,
                    "subjectsFailed": 0,
                    "grades": [
                        {"subject": "التربية الإسلامية", "total": "76.0 / 80.0", "status": "ناجح"},
                        {"subject": "اللغة العربية (علمي)", "total": "152.0 / 160.0", "status": "ناجح"},
                        {"subject": "اللغة الإنجليزية (علمي)", "total": "135.0 / 160.0", "status": "ناجح"},
                        {"subject": "تقنية المعلومات (علمي)", "total": "74.0 / 80.0", "status": "ناجح"},
                        {"subject": "الرياضيات", "total": "176.0 / 200.0", "status": "ناجح"},
                        {"subject": "الإحصاء (علمي)", "total": "72.0 / 80.0", "status": "ناجح"},
                        {"subject": "الفيزياء", "total": "160.0 / 200.0", "status": "ناجح"},
                        {"subject": "الكيمياء", "total": "129.0 / 160.0", "status": "ناجح"},
                        {"subject": "الأحياء", "total": "137.0 / 160.0", "status": "ناجح"}
                    ]
                },
                {
                    "number": 3390600,
                    "name": "علي محمد حسن",
                    "stream": "علمي",
                    "overallPercentage": 78.2,
                    "result": "جيد جدًا",
                    "subjectsPassed": 8,
                    "subjectsFailed": 1,
                    "grades": [
                        {"subject": "التربية الإسلامية", "total": "70.0 / 80.0", "status": "ناجح"},
                        {"subject": "اللغة العربية (علمي)", "total": "145.0 / 160.0", "status": "ناجح"},
                        {"subject": "اللغة الإنجليزية (علمي)", "total": "120.0 / 160.0", "status": "ناجح"},
                        {"subject": "تقنية المعلومات (علمي)", "total": "68.0 / 80.0", "status": "ناجح"},
                        {"subject": "الرياضيات", "total": "150.0 / 200.0", "status": "ناجح"},
                        {"subject": "الإحصاء (علمي)", "total": "65.0 / 80.0", "status": "ناجح"},
                        {"subject": "الفيزياء", "total": "142.0 / 200.0", "status": "ناجح"},
                        {"subject": "الكيمياء", "total": "110.0 / 160.0", "status": "راسب"},
                        {"subject": "الأحياء", "total": "130.0 / 160.0", "status": "ناجح"}
                    ]
                }
            ];
            
            preCacheStudentResults();
            
            if (currentPage === 'analytics-page') {
                displaySubjectAnalytics();
            }
            
            // Update dashboard if it's the current page
            if (currentPage === 'dashboard-page') {
                updateDashboard();
            }
        } catch (error) {
            console.error('Error loading student data:', error);
        }
    }

    function preCacheStudentResults() {
        studentsData.forEach(student => {
            let totalScore = 0;
            let maxScore = 0;
            let hasFailure = false;
            
            const gradesWithStatus = student.grades.map(grade => {
                const [scoreStr, maxScoreStr] = grade.total.split('/').map(s => parseFloat(s.trim()));
                totalScore += scoreStr;
                maxScore += maxScoreStr;
                
                const percentage = (scoreStr / maxScoreStr) * 100;
                const failed = grade.status === "راسب" || percentage < 50;
                if (failed) hasFailure = true;
                
                return {
                    subject: grade.subject,
                    score: scoreStr,
                    maxScore: maxScoreStr,
                    failed: failed
                };
            });
            
            const percentage = maxScore > 0 ? (totalScore / maxScore) * 100 : 0;
        
            studentResultsCache[student.number] = {
                name: student.name,
                number: student.number,
                stream: student.stream,
                percentage: percentage,
                result: student.result,
                subjectsPassed: student.subjectsPassed,
                subjectsFailed: student.subjectsFailed,
                hasFailure: hasFailure,
                grades: gradesWithStatus,
                totalScore: totalScore
            };
        });
        
        const allStudents = Object.values(studentResultsCache);
        allStudents.sort((a, b) => b.percentage - a.percentage);
        
        allStudents.forEach((student, index) => {
            student.normalRank = index + 1;
            student.uniqueRank = index + 1;
            student.totalStudents = allStudents.length;
            student.percentile = (allStudents.length - (index + 1)) / (allStudents.length - 1) * 100;
        });
    }

    // ==================== DASHBOARD FUNCTIONS ====================
    function updateDashboard() {
        const allStudents = Object.values(studentResultsCache);
        const passingStudents = allStudents.filter(s => !s.hasFailure).length;
        const failingStudents = allStudents.filter(s => s.hasFailure).length;
        const passRate = (passingStudents / allStudents.length * 100).toFixed(1);
        
        // Update dashboard stats
        document.getElementById('total-students').textContent = allStudents.length;
        document.getElementById('passing-students').textContent = passingStudents;
        document.getElementById('failing-students').textContent = failingStudents;
        document.getElementById('pass-rate').textContent = `${passRate}%`;
        
        // Update support requests table
        populateSupportRequestsTable();
        
        // Create stream distribution chart
        createStreamDistributionChart();
    }

    function populateSupportRequestsTable() {
        const tbody = document.getElementById('supportRequestsBody');
        tbody.innerHTML = '';
        
        supportRequests.forEach(request => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${request.studentName}</td>
                <td>${request.studentNumber}</td>
                <td>${request.failingSubjects}</td>
                <td>${request.city}</td>
                <td>${request.phone}</td>
                <td>${new Date(request.timestamp).toLocaleDateString()}</td>
                <td><span class="status-badge status-new">${currentLanguage === 'ar' ? 'طلب جديد' : 'New'}</span></td>
            `;
            tbody.appendChild(tr);
        });
    }

    function createStreamDistributionChart() {
        const streamCounts = {};
        Object.values(studentResultsCache).forEach(student => {
            streamCounts[student.stream] = (streamCounts[student.stream] || 0) + 1;
        });
        
        const streams = Object.keys(streamCounts);
        const counts = Object.values(streamCounts);
        
        const ctx = document.getElementById('streamChart').getContext('2d');
        
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: streams,
                datasets: [{
                    data: counts,
                    backgroundColor: [
                        'rgba(0, 255, 153, 0.7)',
                        'rgba(77, 148, 255, 0.7)',
                        'rgba(166, 77, 255, 0.7)'
                    ],
                    borderColor: [
                        'rgba(0, 255, 153, 1)',
                        'rgba(77, 148, 255, 1)',
                        'rgba(166, 77, 255, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            color: '#e0e0e0',
                            font: {
                                size: 14
                            }
                        }
                    }
                }
            }
        });
    }

    function exportSupportRequests() {
        const csvContent = "data:text/csv;charset=utf-8," 
            + "اسم الطالب,رقم القيد,المواد الراسبة,المدينة,رقم الهاتف,تاريخ الطلب,الحالة\n"
            + supportRequests.map(request => 
                `"${request.studentName}",${request.studentNumber},"${request.failingSubjects}","${request.city}",${request.phone},${new Date(request.timestamp).toLocaleDateString()},"طلب جديد"`
            ).join("\n");
        
        const encodedUri = encodeURI(csvContent);
        const link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", "طلبات_الدعم.csv");
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    // ==================== SECRET DASHBOARD ACCESS ====================
    function initSecretAccess() {
        const logo = document.getElementById('dashboardSecret');
        let clickCount = 0;
        let clickTimer = null;
        
        logo.addEventListener('click', function() {
            clickCount++;
            
            if (clickCount === 1) {
                // Start timer for double click
                clickTimer = setTimeout(() => {
                    clickCount = 0;
                }, 500);
            } else if (clickCount === 2) {
                clearTimeout(clickTimer);
                clickCount = 0;
                
                // Add animation effect
                logo.classList.add('secret-access');
                setTimeout(() => logo.classList.remove('secret-access'), 500);
                
                // Show password modal
                document.getElementById('password-modal').classList.add('active');
            }
        });
    }

    // ==================== PASSWORD PROTECTION - FIXED ====================
    function initPasswordProtection() {
        const passwordModal = document.getElementById('password-modal');
        const passwordInput = document.getElementById('password-input');
        const passwordBtn = document.getElementById('password-btn');
        const passwordError = document.getElementById('password-error');
        
        // Handle password submission
        passwordBtn.addEventListener('click', function() {
            if (passwordInput.value === DASHBOARD_PASSWORD) {
                passwordModal.classList.remove('active');
                // Navigate to dashboard page
                history.pushState({ page: 'dashboard-page' }, '', '#dashboard');
                loadPage('dashboard-page');
            } else {
                passwordError.style.display = 'block';
                passwordInput.value = '';
                passwordInput.focus();
                
                // Add shake animation
                passwordInput.parentElement.classList.add('shake');
                setTimeout(() => {
                    passwordInput.parentElement.classList.remove('shake');
                }, 500);
            }
        });
        
        // Handle Enter key
        passwordInput.addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                passwordBtn.click();
            }
        });
    }

    // ==================== SUPPORT REQUEST HANDLING ====================
    function handleSupportRequest() {
        document.getElementById('supportForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const request = {
                studentName: document.getElementById('studentName').value,
                studentNumber: parseInt(document.getElementById('studentNumberInput').value),
                failingSubjects: document.getElementById('failingSubjects').value,
                city: document.getElementById('city').value,
                phone: document.getElementById('phone').value,
                status: "جديد",
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage
            supportRequests.push(request);
            localStorage.setItem('supportRequests', JSON.stringify(supportRequests));
            
            // Show success message
            alert(currentLanguage === 'ar' ? 'تم إرسال طلبك بنجاح' : 'Your request has been submitted successfully');
            document.getElementById('supportModal').classList.remove('active');
            
            // Clear form
            document.getElementById('city').value = '';
            document.getElementById('phone').value = '';
            
            // Update dashboard if it's the current page
            if (currentPage === 'dashboard-page') {
                populateSupportRequestsTable();
            }
        });
    }

    // ==================== PAGE MANAGEMENT - FIXED ====================
    function initRouting() {
        const hash = window.location.hash;
        let pageId = 'home-page';
        
        if (hash === '#analytics') pageId = 'analytics-page';
        else if (hash === '#about') pageId = 'about-page';
        else if (hash === '#dashboard') {
            // Show password modal for dashboard access
            pageId = 'home-page';
            setTimeout(() => {
                document.getElementById('password-modal').classList.add('active');
            }, 500);
        }
        
        loadPage(pageId);
    }

    function loadPage(pageId) {
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        const navLink = document.querySelector(`.nav-link[data-page="${pageId}"]`);
        if (navLink) navLink.classList.add('active');
        
        document.querySelectorAll('.page').forEach(page => {
            page.classList.remove('active');
        });
        document.getElementById(pageId).classList.add('active');
        currentPage = pageId;
        
        if (pageId === 'analytics-page') {
            displaySubjectAnalytics();
        } else if (pageId === 'dashboard-page') {
            updateDashboard();
        }
    }

    // ==================== STUDENT DISPLAY FUNCTIONS ====================
    function displayStudentResults() {
        const studentNumber = parseInt(document.getElementById('studentNumberInput').value);
        const resultsContainer = document.getElementById('results-container');
        const errorMsg = document.getElementById('error-message');
        const feedbackBanner = document.getElementById('result-feedback-banner');
        
        if (feedbackTimeout) {
            clearTimeout(feedbackTimeout);
            feedbackTimeout = null;
        }
        
        feedbackBanner.classList.remove('visible', 'fade-out', 'has-failure');
        resultsContainer.classList.remove('visible');
        resultsContainer.style.display = "none";

        const studentResult = studentResultsCache[studentNumber];
        
        if (!studentResult) { 
            errorMsg.style.display = 'block'; 
            return; 
        }
        
        errorMsg.style.display = 'none';

        resultsContainer.innerHTML = '';
    
        const studentHeader = document.createElement('div');
        studentHeader.className = 'student-header';
        
        const studentName = document.createElement('h2');
        studentName.textContent = studentResult.name;
        studentHeader.appendChild(studentName);
        resultsContainer.appendChild(studentHeader);
        
        const studentInfo = document.createElement('div');
        studentInfo.className = 'student-info';
        
        const infoItems = [
            { label: 'رقم القيد', value: studentResult.number },
            { label: 'المسار', value: studentResult.stream },
            { label: 'المجموع الكلي', value: studentResult.totalScore },
            { label: 'النتيجة', value: studentResult.result }
        ];
        
        infoItems.forEach(item => {
            const infoItem = document.createElement('div');
            infoItem.className = 'student-info-item';
            
            const label = document.createElement('p');
            label.textContent = item.label;
            infoItem.appendChild(label);
            
            const value = document.createElement('span');
            value.textContent = item.value;
            infoItem.appendChild(value);
            
            studentInfo.appendChild(infoItem);
        });
        
        resultsContainer.appendChild(studentInfo);
        
        const statsGrid = document.createElement('div');
        statsGrid.className = 'stats-grid';
        
        const percentageContainer = document.createElement('div');
        percentageContainer.className = `percentage-circle-container ${studentResult.hasFailure ? 'has-failure' : ''}`;
        
        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        const circleBg = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circleBg.setAttribute('class', 'circle-bg');
        circleBg.setAttribute('cx', '75');
        circleBg.setAttribute('cy', '75');
        circleBg.setAttribute('r', '65');
        
        const circleProgress = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circleProgress.setAttribute('id', 'circleProgress');
        circleProgress.setAttribute('class', 'circle-progress');
        circleProgress.setAttribute('cx', '75');
        circleProgress.setAttribute('cy', '75');
        circleProgress.setAttribute('r', '65');
        
        svg.appendChild(circleBg);
        svg.appendChild(circleProgress);
        percentageContainer.appendChild(svg);
        
        const percentageText = document.createElement('div');
        percentageText.id = 'percentageText';
        percentageText.className = 'percentage-text';
        percentageText.textContent = '0%';
        percentageContainer.appendChild(percentageText);
        
        const percentageLabel = document.createElement('p');
        percentageLabel.textContent = 'النسبة المئوية';
        percentageContainer.appendChild(percentageLabel);
        
        statsGrid.appendChild(percentageContainer);
        
        const rankItem = document.createElement('div');
        rankItem.className = 'rank-item';
        
        const rankTitle = document.createElement('p');
        rankTitle.textContent = 'الترتيب';
        rankItem.appendChild(rankTitle);
        
        const normalRank = document.createElement('span');
        normalRank.className = 'rank-normal';
        normalRank.textContent = `#${studentResult.normalRank}`;
        rankItem.appendChild(normalRank);
        
        const rankSubtitle = document.createElement('p');
        rankSubtitle.textContent = `من أصل ${studentResult.totalStudents} طالب`;
        rankItem.appendChild(rankSubtitle);
        
        statsGrid.appendChild(rankItem);
        resultsContainer.appendChild(statsGrid);
        
        const subjectBarsContainer = document.createElement('div');
        subjectBarsContainer.className = 'subject-bars-container';
        
        const subjectTitle = document.createElement('h3');
        subjectTitle.textContent = 'مستوى المواد';
        subjectBarsContainer.appendChild(subjectTitle);
        
        studentResult.grades.forEach(grade => {
            const subjectBar = document.createElement('div');
            subjectBar.className = 'subject-bar';
            
            const subjectBarInfo = document.createElement('div');
            subjectBarInfo.className = 'subject-bar-info';
            
            const subjectName = document.createElement('span');
            subjectName.textContent = grade.subject;
            subjectBarInfo.appendChild(subjectName);
            
            const scoreInfo = document.createElement('span');
            scoreInfo.textContent = `${grade.score} / ${grade.maxScore}`;
            
            if (grade.failed) {
                const failedLabel = document.createElement('span');
                failedLabel.className = 'failed-label';
                failedLabel.textContent = '(مادة راسبة)';
                scoreInfo.appendChild(document.createTextNode(' '));
                scoreInfo.appendChild(failedLabel);
            }
            
            subjectBarInfo.appendChild(scoreInfo);
            subjectBar.appendChild(subjectBarInfo);
            
            const progressBarBg = document.createElement('div');
            progressBarBg.className = 'progress-bar-bg';
            
            const progressBarFill = document.createElement('div');
            progressBarFill.className = `progress-bar-fill ${grade.failed ? 'failed' : ''}`;
            progressBarFill.dataset.score = grade.score;
            progressBarFill.dataset.max = grade.maxScore;
            
            progressBarBg.appendChild(progressBarFill);
            subjectBar.appendChild(progressBarBg);
            
            subjectBarsContainer.appendChild(subjectBar);
        });
        
        resultsContainer.appendChild(subjectBarsContainer);
        
        const chartContainer = document.createElement('div');
        chartContainer.id = 'chart-container';
        
        const performanceCanvas = document.createElement('canvas');
        performanceCanvas.id = 'performanceChart';
        chartContainer.appendChild(performanceCanvas);
        
        resultsContainer.appendChild(chartContainer);
        
        resultsContainer.style.display = 'block';
        
        setTimeout(() => {
            resultsContainer.classList.add('visible');
            
            const radius = circleProgress.r.baseVal.value;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (studentResult.percentage / 100) * circumference;
            
            circleProgress.style.strokeDasharray = `${circumference} ${circumference}`;
            circleProgress.style.strokeDashoffset = offset;
            
            animateValue(percentageText, 0, studentResult.percentage, 1000, true);
            
            document.querySelectorAll('.progress-bar-fill').forEach(f => {
                const percentage = (f.dataset.score / f.dataset.max) * 100;
                f.style.width = `${percentage}%`;
            });
            
            if (studentResult.hasFailure) {
                const failedSubjects = studentResult.grades
                    .filter(grade => grade.failed)
                    .map(grade => grade.subject)
                    .join('، ');
                
                feedbackBanner.innerHTML = `
                    <p>لقد فشلت في ${studentResult.subjectsFailed} مادة. هل ترغب في الحصول على معلومات حول دورات الدعم؟</p>
                    <button class="support-btn" id="supportButton">طلب دورة الدعم</button>
                `;
                feedbackBanner.classList.add('has-failure');
                
                document.getElementById('supportButton').addEventListener('click', () => {
                    document.getElementById('studentName').value = studentResult.name;
                    document.getElementById('failingSubjects').value = failedSubjects;
                    document.getElementById('supportModal').classList.add('active');
                });
            } else {
                feedbackBanner.textContent = `ممتاز! لقد نجحت في جميع المواد بنسبة ${studentResult.percentage.toFixed(1)}%.`;
            }
            
            feedbackBanner.classList.add('visible');
            
            feedbackTimeout = setTimeout(() => {
                feedbackBanner.classList.add('fade-out');
            }, 10000);
            
            if (performanceChart) performanceChart.destroy();
            
            const subjectLabels = studentResult.grades.map(g => g.subject);
            const subjectData = studentResult.grades.map(g => (g.score / g.maxScore) * 100);
            
            performanceChart = new Chart(performanceCanvas, {
                type: 'radar',
                data: { 
                    labels: subjectLabels, 
                    datasets: [{
                        data: subjectData, 
                        backgroundColor: 'rgba(0, 255, 153, 0.2)', 
                        borderColor: 'rgb(0, 255, 153)', 
                        pointBackgroundColor: 'rgb(0, 255, 153)', 
                        pointBorderColor: '#fff',
                        borderWidth: 2,
                        pointRadius: 4
                    }] 
                },
                options: { 
                    maintainAspectRatio: false,
                    scales: { 
                        r: { 
                            angleLines: { color: 'rgba(255, 255, 255, 0.2)' }, 
                            grid: { color: 'rgba(255, 255, 255, 0.2)' }, 
                            pointLabels: { 
                                color: '#e0e0e0', 
                                font: { size: 12 } 
                            }, 
                            suggestedMin: 0, 
                            suggestedMax: 100, 
                            ticks: { 
                                display: false,
                                stepSize: 20
                            } 
                        } 
                    }, 
                    plugins: { 
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const subjectIndex = context.dataIndex;
                                    const subject = studentResult.grades[subjectIndex];
                                    return `${subject.subject}: ${subject.score}/${subject.maxScore} (${((subject.score / subject.maxScore) * 100).toFixed(1)}%)`;
                                }
                            }
                        }
                    } 
                }
            });
        }, 100);
    }
    
    function animateValue(obj, start, end, duration, isPercent) {
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            let val = isPercent ? (progress * (end - start) + start).toFixed(2) : Math.floor(progress * (end - start) + start);
            obj.textContent = isPercent ? `${val}%` : val;
            if (progress < 1) window.requestAnimationFrame(step);
        };
        window.requestAnimationFrame(step);
    }
    
    // ==================== INITIALIZATION ====================
    document.addEventListener('DOMContentLoaded', function() {
        fetchStudentData();
        initSecretAccess();
        initPasswordProtection();
        handleSupportRequest();
        initRouting();
        
        // Language selector functionality
        document.getElementById('languageToggle').addEventListener('click', function(e) {
            e.stopPropagation();
            document.getElementById('languageDropdown').classList.toggle('show');
        });
        
        document.querySelectorAll('.language-option').forEach(option => {
            option.addEventListener('click', function() {
                const lang = this.dataset.lang;
                updateLanguage(lang);
            });
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function() {
            document.getElementById('languageDropdown').classList.remove('show');
        });

        // Event listeners
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const pageId = this.dataset.page;
                history.pushState({ page: pageId }, '', this.getAttribute('href'));
                loadPage(pageId);
            });
        });
        
        window.addEventListener('popstate', function() {
            initRouting();
        });
        
        document.getElementById('searchButton').addEventListener('click', displayStudentResults);
        document.getElementById('studentNumberInput').addEventListener('keyup', (e) => {
            if (e.key === 'Enter') displayStudentResults();
        });
        
        document.getElementById('modalClose').addEventListener('click', () => {
            document.getElementById('supportModal').classList.remove('active');
        });
        
        document.getElementById('cancelSupport').addEventListener('click', () => {
            document.getElementById('supportModal').classList.remove('active');
        });
        
        document.getElementById('exportRequestsBtn').addEventListener('click', exportSupportRequests);
    });
    </script>
</body>
</html>
